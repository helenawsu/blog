@import "tailwindcss";
@import "./typography.css";
@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

:root,
html[data-theme="light"] {
  --background: #f4f0ee;
  --foreground: #413741;
  --accent: #9bcf00;
  --muted: #d9dbcd;
  --border: #85552b;
}

html[data-theme="dark"] {
  --background: #354649;
  --foreground: #eaedf3;
  --accent: #ff6b01;
  --muted: #343f60;
  --border: #6dab08;
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-accent: var(--accent);
  --color-muted: var(--muted);
  --color-border: var(--border);
}

@layer base {
  * {
    @apply border-border outline-accent/75;
    scrollbar-width: auto;
    scrollbar-color: var(--color-muted) transparent;
  }
  html {
    @apply overflow-y-scroll scroll-smooth;
  }
  body {
    @apply flex min-h-svh flex-col bg-background font-mono text-foreground selection:bg-accent/75 selection:text-background;
  }
  a,
  button {
    @apply outline-offset-1 outline-accent focus-visible:no-underline focus-visible:outline-2 focus-visible:outline-dashed;
  }
  button:not(:disabled),
  [role="button"]:not(:disabled) {
    cursor: pointer;
  }
  section,
  footer {
    @apply mx-auto max-w-app px-4;
  }
}

@utility max-w-app {
  @apply max-w-3xl;
}

.active-nav {
  @apply underline decoration-wavy decoration-2 underline-offset-4;
}

/* Source: https://piccalil.li/blog/a-more-modern-css-reset/ */
/* Anything that has been anchored to should have extra scroll margin */
:target {
  scroll-margin-block: 1rem;
}
.side-by-side {
  display: flex;
  gap: 1rem;
  align-items: flex-start;
}
.side-by-side > div {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: center;
}
.side-by-side img {
    margin-top: 0rem;

  max-width: 100%;
  height: auto;
  margin-bottom: 0rem;
}
.side-by-side figcaption {
  text-align: center;
  margin-top: 0rem; /* Reduce this value for less space */

}
.hover-swap {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.hover-swap .img-container {
  position: relative;
  width: 100%;
  display: flex;
  justify-content: center;
}

.hover-swap .main-img {
  display: block;
}

.hover-swap .hover-img {
  position: absolute;
  top: 0;
  left: 0;
  display: none;
  width: 100%;
  height: auto;
}

/* Ensure figcaption is always below image */
.hover-swap figcaption {
  width: 100%;
  order: 2;
  margin-top: 0.5rem;
  text-align: center;
}

.hover-swap .caption-hover {
  display: none;
}
.hover-swap:hover .caption-default {
  display: none;
}
.hover-swap:hover .caption-hover {
  display: block;
}

.hover-swap:hover .main-img {
  display: none;
}

.hover-swap:hover .hover-img {
  display: block;
}

.toc-thumbs {
  position: fixed;
  left: 1rem;
  top: 6.5rem;
  width: 300px;
  max-height: calc(100vh - 8rem);
  overflow-y: auto;
  padding: 0.5rem;
  z-index: 50;
  background: transparent;
  pointer-events: auto;
}

.toc-thumbs-list {
  list-style: none;
  margin: 0;
  padding: 0.25rem 0;
}

.toc-thumbs-list.nested {
  padding-left: 0.5rem;
}

.toc-item { display: block; }

.toc-link {
  display: block;
  text-decoration: none;
  color: inherit;
  padding: 0.25rem 0.375rem;
  border-radius: 6px;
  font-size: 0.9rem;
}

.toc-link:hover,
.toc-link.active {
  background: rgba(0,0,0,0.04);
  color: var(--color-accent);
}

/* level indentation */
.toc-item.level-1 { padding-left: 0; }
.toc-item.level-2 { padding-left: 0.5rem; }
.toc-item.level-3 { padding-left: 1rem; }

/* level font sizes apply to the link so they aren't overridden */
.toc-item.level-2 .toc-link { font-size: 0.8rem;color: rgb(129, 129, 129);}
.toc-item.level-3 .toc-link { font-size: 0.75rem; color: rgb(151, 151, 151);}

/* Responsive: hide on small screens */
@media (max-width: 1250px) {
  .toc-thumbs { display: none; }
}

/* Do not change main layout; TOC is fixed and should not shift content */
@media (min-width: 901px) {
  .toc-thumbs { left: 1rem; }
}

/* enable smooth scrolling for TOC links */
html { scroll-behavior: smooth; }

/* active link styling */
.toc-link.active {
  font-weight: 600;
  color: var(--color-accent);
  background: rgba(0,0,0,0.04);
  border-left: 3px solid var(--color-accent);
  padding-left: 0.25rem;
}

/* placeholder thumbnail when no image is available */
.toc-thumb.placeholder {
  display: inline-block;
  width: 56px;
  height: 40px;
  border-radius: 4px;
  background: linear-gradient(135deg, rgba(0,0,0,0.04), rgba(0,0,0,0.02));
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.02);
}

/* Horizontal gallery: one-line square images with horizontal scrolling */
.horizontal-gallery {
  width: 100%;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: contain;
}
.horizontal-gallery .hg-track {
  display: flex;
  gap: 0.75rem;
  padding: 0.25rem 0.25rem;
  align-items: stretch;
  /* enable snap */
  scroll-snap-type: x mandatory;
}
.horizontal-gallery .hg-item {
  flex: 0 0 auto;
  width: min(220px, 28vw);
  aspect-ratio: auto; /* let media define aspect */
  border-radius: 0px;
  overflow: hidden;
  background: transparent;
  scroll-snap-align: center;
  display: flex;
  flex-direction: column;
  align-items: stretch;
}

/* Remove visible borders/shadows from gallery items */
.horizontal-gallery .hg-item {
  box-shadow: none !important;
  border: none !important;
  outline: none !important;
}
.horizontal-gallery .hg-media,
.horizontal-gallery .hg-media img,
.horizontal-gallery .hg-item img {
  border: none !important;
  outline: none !important;
  box-shadow: none !important;
}
.horizontal-gallery .hg-caption {
  border-top: none !important;
  background: transparent;
}

.horizontal-gallery .hg-media {
  width: 100%;
  aspect-ratio: 1 / 1;
  overflow: hidden;
  display: block;
  /* remove background so image fills the area without visible padding */
  background: transparent;
}
.horizontal-gallery .hg-item img {
  width: 100%;
  height: 100%;
  object-fit: cover; /* fit-crop: fill and crop to square */
  object-position: center;
  display: block;
  margin-top: 1rem;
}
.horizontal-gallery .hg-caption {
  padding: 0.35rem 0.5rem;
  font-size: 0.85rem;
  color: var(--color-foreground);
  text-align: center;
}

/* optional fading edges */
.horizontal-gallery::before,
.horizontal-gallery::after {
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  width: 2.5rem;
  pointer-events: none;
}
/* Use the theme background variable so the fade matches dark/light mode */
.horizontal-gallery::before { left: 0; background: linear-gradient(90deg, var(--color-background), transparent); }
.horizontal-gallery::after { right: 0; background: linear-gradient(270deg, var(--color-background), transparent); }

/* Adjust spacing for H2 headings */
h2,
.app-prose h2 {
  margin-top: 1.25rem; /* space above H2 */
  margin-bottom: 0.5rem; /* space below H2 */
  line-height: 1.25;
}

@media (max-width: 640px) {
  h2,
  .app-prose h2 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }
}
h1,
.app-prose h1 {
  margin-top: 2.5rem; /* space above H1 */
  margin-bottom: 0.5rem; /* space below H1 */
}

@media (max-width: 640px) {
  h1,
  .app-prose h1 {
    margin-top: 1rem;
    margin-bottom: 0.5rem;
  }
}
.side-by-side-arrows {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.75rem;
  width: auto; /* don't force full width so auto margins can center */
  max-width: 900px; /* constrain the group so it centers within content */
  flex-wrap: nowrap;
  margin: 1rem auto; /* center horizontally */
  --ssa-caption-space: 2.4rem; /* default reserved space for caption */
}

.ssa-item {
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
  width: min(220px, 22vw);
  margin-top: 0rem;
  margin-bottom: 0.5rem;
  border: none !important;
  padding-bottom: var(--ssa-caption-space); /* reserve larger space so caption sits further below image */
}

.ssa-item img {
  width: 100%;
  height: auto;
  max-height: 220px;
  object-fit: cover;
  border-radius: 0px;
  border: none !important; 
}
.ssa-item figcaption {
  position: absolute;
  left: 50%;
  transform: translateX(-50%);
  bottom: calc(var(--ssa-caption-space) - 1.65rem); /* position caption inside reserved space */
  margin: 0;
  font-size: 0.85rem;
  text-align: center;
  width: 100%;
}

.ssa-arrow {
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.25rem;
  color: var(--color-foreground);
  padding: 0 0.5rem;
  /* shift arrow up by half the reserved caption space so it visually centers to the image */
  transform: translateY(calc(-0.5 * var(--ssa-caption-space)));
}

@media (max-width: 640px) {
  .side-by-side-arrows { gap: 0.5rem; --ssa-caption-space: 1.6rem; }
  .ssa-item { width: 36vw; }
  .ssa-item img { max-height: 160px; }
  .ssa-item figcaption { bottom: calc(var(--ssa-caption-space) - 1.25rem); }
}

/* Grid gallery */
.grid-gallery {
  width: 100%;
}
.grid-gallery .gg-track {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.75rem;
  align-items: start;
}
@media (max-width: 900px) {
  .grid-gallery .gg-track { grid-template-columns: repeat(2, minmax(0, 1fr)); }
}
@media (max-width: 480px) {
  .grid-gallery .gg-track { grid-template-columns: repeat(1, minmax(0, 1fr)); }
}
.grid-gallery .gg-item {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  border: none !important;
  outline:none !important;
}
.grid-gallery .gg-media {
  width: 100%;
  aspect-ratio: 1 / 1;
  overflow: hidden;
  border-radius: 0px;
}
.grid-gallery .gg-media img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  border: none !important; 
  transition: filter 200ms ease, transform 200ms ease;
}

/* hover / focus effect: make image greyer and slightly dim */
.grid-gallery .gg-item:hover .gg-media img,
.grid-gallery .gg-item:focus-within .gg-media img {
  filter: grayscale(70%) brightness(0.9) contrast(0.98);
  transform: scale(0.998);
}
.grid-gallery .gg-caption {
  font-size: 0.85rem;
 color: var(--color-foreground);
  text-align: center;
}

/* Modal / lightbox */
.gg-modal {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  background: rgba(0,0,0,0.6);
  z-index: 60;
  padding: 2rem;
}
.gg-modal[hidden] { display: none; }
.gg-close {
  position: absolute;
  top: 1rem;
  right: 1rem;
  background: transparent;
  border: none;
  color: white;
  font-size: 1.5rem;
  cursor: pointer;
}
.gg-figure {
  max-width: 90vw;
  max-height: 90vh;
}
.gg-figure img {
  width: 100%;
  height: auto;
  display: block;
  max-height: 80vh;
}
.gg-caption {
  margin-top: 0.5rem;
  text-align: center;
  color: #fff;
}

/* Equal square tiles for side-by-side showcases */
.side-by-side.equal {
  align-items: stretch;
  gap: 1rem;
}
.side-by-side.equal > figure {
  flex: 1 1 0;
  display: flex;
  flex-direction: column;
  margin: 0;
}
.side-by-side.equal > figure img,
.side-by-side.equal > figure .img-container img {
  width: 100%;
  aspect-ratio: 1 / 1;
  object-fit: cover;
  display: block;
  border: none !important;
  box-shadow: none !important;
}
.side-by-side.equal > figure figcaption {
  margin-top: 0.35rem;
  text-align: center;
}